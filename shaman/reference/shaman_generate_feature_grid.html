<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate spatial enrichment of contacts between two features — shaman_generate_feature_grid • shaman</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">shaman</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/shaman-package.html">
    <span class="fa fa-road"></span>
     
    Usage
  </a>
</li>
<li>
  <a href="../articles/import.html">
    <span class="fa fa-filter"></span>
     
    Import
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bitbucket.org/tanaylab/shaman">
    <span class="fa fa-bitbucket-square"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate spatial enrichment of contacts between two features</h1>
    </div>

    
    <p><code>shaman_generate_feature_grid</code></p>
    

    <pre class="usage"><span class='fu'>shaman_generate_feature_grid</span>(<span class='no'>feature1</span>, <span class='no'>feature2</span>, <span class='no'>obs_track_nm</span>,
  <span class='kw'>exp_track_nm</span> <span class='kw'>=</span> <span class='fu'>paste0</span>(<span class='no'>obs_track_nm</span>, <span class='st'>"_shuffle"</span>),
  <span class='kw'>score_track_nm</span> <span class='kw'>=</span> <span class='fu'>paste0</span>(<span class='no'>obs_track_nm</span>, <span class='st'>"_score"</span>), <span class='kw'>score_filter</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>range</span> <span class='kw'>=</span> <span class='fl'>25000</span>, <span class='kw'>resolution</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>min_dist</span> <span class='kw'>=</span> <span class='fl'>2e+05</span>, <span class='kw'>max_dist</span> <span class='kw'>=</span> <span class='fl'>1e+06</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>feature1</th>
      <td><p>1d intervals representing feature 1. Strand, if provided will be ignored.</p></td>
    </tr>
    <tr>
      <th>feature2</th>
      <td><p>1d intervals representing feature 2. Strand, if provided will be ignored.</p></td>
    </tr>
    <tr>
      <th>obs_track_nm</th>
      <td><p>Name of observed 2D genomic track for the hic data.</p></td>
    </tr>
    <tr>
      <th>exp_track_nm</th>
      <td><p>Name of expected 2D genomic track.</p></td>
    </tr>
    <tr>
      <th>score_track_nm</th>
      <td><p>Name of 2D score track. If track doesn't exist, no filter on grid will be applied.</p></td>
    </tr>
    <tr>
      <th>score_filter</th>
      <td><p>Minimum value of score within the expanded window surrounding the grid point for the window
to be considered in the statistics.</p></td>
    </tr>
    <tr>
      <th>range</th>
      <td><p>Window size around the grid point.</p></td>
    </tr>
    <tr>
      <th>resolution</th>
      <td><p>Size of bins (in base pairs).</p></td>
    </tr>
    <tr>
      <th>min_dist</th>
      <td><p>Minimum distance between features on the grid.</p></td>
    </tr>
    <tr>
      <th>max_dist</th>
      <td><p>Maximum distance between features on the grid.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list containing obs - observed matrix, sum of the number of observed contacts in each bin in the window,
exp - expected matrix, sum of the number of expected contacts in each bin in the window,
grid_size - number of windows included in statistics</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Build a grid comprising of all combinations of intervals from feature 1 and feature 2 that
fall within a band defined by min_dist and max_dist. For each point on the grid,
look at th surrounding window, defined by range parameter. Discard all windows
that do not contain a point with a score (defined in scotre_track_nm) above the score_filter parameter.
This allows for focusing on potentially enriched pairs.
Discect the window into small bins, size in base pairs defined by the resolution parameter, and count
the number of observed contacts, and the number of expected contacts in each bin.
All windows are then summed together, generating a single matrix of observed and expected contacts, which is
returned by function.
Note that grid contains only points in which feature 1 position is smaller than feature 2 position.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>#Set misha db to test</span>
<span class='fu'>gsetroot</span>(<span class='fu'><a href='shaman_get_test_track_db.html'>shaman_get_test_track_db</a></span>())
<span class='no'>grid</span> <span class='kw'>=</span> <span class='fu'>shaman_generate_feature_grid</span>(<span class='kw pkg'>shaman</span><span class='kw ns'>::</span><span class='no'><a href='http://www.rdocumentation.org/packages/shaman/topics/ctcf_forward'>ctcf_forward</a></span>, <span class='kw pkg'>shaman</span><span class='kw ns'>::</span><span class='no'><a href='http://www.rdocumentation.org/packages/shaman/topics/ctcf_reverse'>ctcf_reverse</a></span>, <span class='st'>"hic_obs"</span>,
<span class='kw'>exp_track_nm</span><span class='kw'>=</span><span class='st'>"hic_exp"</span>)</div><div class='output co'>#&gt; <span class='message'>building grid...</span></div><div class='output co'>#&gt; <span class='message'>screening for filter</span></div><div class='output co'>#&gt; <span class='message'>found  43999 regions</span></div><div class='output co'>#&gt; <span class='message'>obs neighbors...</span></div><div class='output co'>#&gt; 34%...82%...100%</div><div class='output co'>#&gt; <span class='message'>exp neighbors...</span></div><div class='output co'>#&gt; 56%...100%</div><div class='input'><span class='no'>plot</span> <span class='kw'>=</span> <span class='fu'><a href='shaman_plot_feature_grid.html'>shaman_plot_feature_grid</a></span>(<span class='fu'>list</span>(<span class='no'>grid</span>), <span class='fl'>25000</span>, <span class='fl'>500</span>, <span class='fl'>1000</span>)</div><div class='output co'>#&gt; <span class='message'>Using sum as value column: use value.var to override.</span></div><div class='output co'>#&gt; <span class='message'>Using sum as value column: use value.var to override.</span></div><div class='img'><img src='shaman_generate_feature_grid-1.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Amos Tanay, Netta Mendelson Cohen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
