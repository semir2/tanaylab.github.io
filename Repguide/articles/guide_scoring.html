<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>guideRNA scoring • Repguide</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="guideRNA scoring">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Repguide</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/Repguide.html">
    <span class="fa fa-play-circle"></span>
     
    Get started
  </a>
</li>
<li>
  <a href="../articles/benchmark.html">
    <span class="fa fa-bar-chart"></span>
     
    Benchmark
  </a>
</li>
<li>
  <a href="../articles/guide_scoring.html">
    <span class="fa fa-star"></span>
     
    Guide scoring
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-news"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://bitbucket.org/tanaylab/repguide/src/default/">
    <span class="fa fa-bitbucket-square"></span>
     
    Bitbucket
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>guideRNA scoring</h1>
                        <h4 class="author">David Brocks</h4>
            
            <h4 class="date">2019-07-31</h4>
      
      
      <div class="hidden name"><code>guide_scoring.Rmd</code></div>

    </div>

    
    
<div id="binding-score" class="section level2">
<h2 class="hasAnchor">
<a href="#binding-score" class="anchor"></a>Binding score</h2>
<p>To define the binding affinity of a guide to its genomic target, we modified the scoring formula from <a href="http://bioinfogp.cnb.csic.es/tools/breakingcas/">Breaking-Cas</a> [1] which assigns a score based on the total number and invidivual positions of the guides’ mismatches: <span class="math display">\[ S_{bind} = \prod_{p\in{M}}(W_p)\times\frac{1}{\frac{n\_bps-d}{n\_bps}\ + 1}\times\frac{1}{m^{2}} \]</span> Where <em>n_bps</em> is defined as the length of the guideRNA - 1, <em>Wp</em> is the weight of a mismatch at position <em>p</em> (linear decrease with distance to PAM), <em>m</em> is the total number of mismatches, and <em>d</em> is a proxy for the average pairwise distance between all mismatches: <span class="math display">\[d = \frac{max\_pos - min\_pos}{m - 1}\]</span> Perfectly complementary binding sites are scored with a value of 1, while binding sites with a single mismatch will reduce binding score by at least 0.5. This scoring scheme is consistent with emperical data from Gilbert et al., 2014 [2].</p>
</div>
<div id="cis-score" class="section level2">
<h2 class="hasAnchor">
<a href="#cis-score" class="anchor"></a>Cis score</h2>
<p>Since CRISPRi/a efficiency depends on dCas9 recruitment to regulatory features [3], we further score the impact of predicted genomic off-target sites by their basepair distance to the nearest cis-regulatory element (<em>cis</em>), consistent with reports: <span class="math display">\[S_{cis} = {Top} + \frac{(Bottom - Top)}{1 + exp(\frac{V50 - cis}{Slope\times100})}\]</span> This equation describes the Boltzmann sigmoid function, where V50 is the basepair distance at which the score is halfway between Top (1) and Bottom (0.1) (2kb by default) and slope represents the steepness of the sigmoid curve (5 by default).</p>
</div>
<div id="on--and-off-target-score" class="section level2">
<h2 class="hasAnchor">
<a href="#on--and-off-target-score" class="anchor"></a>On- and off-target score</h2>
<div id="per-genomic-binding-site" class="section level4">
<h4 class="hasAnchor">
<a href="#per-genomic-binding-site" class="anchor"></a>Per genomic binding site</h4>
<p>The final off-target score for a predicted off-target binding site is defined as the product of both scores: <span class="math display">\[ S_{off} = S_{bind}\times S_{cis} \]</span> while the on target score of an on-target binding site is simply defined as: <span class="math display">\[ S_{on} = S_{bind} \]</span></p>
<p>We then summarise the on- and off-target scores for a guide (<em>Sguide_off</em> and <em>Sguide_on</em>) over all predicted off- and on-target binding sites (Soff and Son) by first calculating the maximal score of a locus <em>l</em> and guide <em>g</em>: <span class="math display">\[ Slocus_{on}(l,g) = \max_{b\in B_{l}} S_{on} \]</span> <span class="math display">\[ Slocus_{off}(l,g) = \max_{b\in B_{l}} S_{off} \]</span> where <em>Bl</em> is the set of all the on/off-target binding sites of locus <em>l</em>. A Locus is defined as either the full-length transposon interval (variable size) or a genomic bin of size 500 bps by default.</p>
</div>
<div id="per-guiderna" class="section level4">
<h4 class="hasAnchor">
<a href="#per-guiderna" class="anchor"></a>Per guideRNA</h4>
<p>The total off- and on-target score of a guide is then simply defined as: <span class="math display">\[ Sguide_{on}(g) = \sum\limits_{l\in L_{on}} Slocus_{on}(l,g) \]</span> <span class="math display">\[ Sguide_{off}(g) = \sum\limits_{l\in L_{off}} Slocus_{off}(l,g) \]</span></p>
</div>
<div id="per-combination-of-guidernas" class="section level4">
<h4 class="hasAnchor">
<a href="#per-combination-of-guidernas" class="anchor"></a>Per combination of guideRNAs</h4>
<p>Similarly, off- and on-target scores for combinations of guides (<em>Scomb</em>) are summarized for each locus l and guide g: <span class="math display">\[ Scomb_{off}(c) = \sum\limits_{l\in L_{off}} \max_{g\in G} Slocus_{off}(l,g)  \]</span> <span class="math display">\[ Scomb_{on}(c) = \sum\limits_{l\in L_{on}} \max_{g\in G} Slocus_{on}(l,g)  \]</span></p>
</div>
</div>
<div id="optimal-guiderna-combination" class="section level2">
<h2 class="hasAnchor">
<a href="#optimal-guiderna-combination" class="anchor"></a>Optimal guideRNA combination</h2>
<p>Repguide suggests the ideal combination of guides based on the set that maximizes: <span class="math display">\[ Scomb_{on} - Scomb_{off}\times \alpha \]</span> Where the user-defined <em>alpha</em> coefficient determines the weight of predicted off-targets.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>[1] Oliveros, J. C. et al. Breaking-Cas-interactive design of guide RNAs for CRISPR-Cas experiments for ENSEMBL genomes. Nucleic Acids Res. (2016). <a href="doi:10.1093/nar/gkw407" class="uri">doi:10.1093/nar/gkw407</a><br>
[2] Gilbert, L. A. et al. Genome-Scale CRISPR-Mediated Control of Gene Repression and Activation. Cell (2014). <a href="doi:10.1016/j.cell.2014.09.029" class="uri">doi:10.1016/j.cell.2014.09.029</a><br>
[3] Radzisheuskaya, A., Shlyueva, D., Müller, I. &amp; Helin, K. Optimizing sgRNA position markedly improves the efficiency of CRISPR/dCas9-mediated transcriptional repression. Nucleic Acids Res. (2016). <a href="doi:10.1093/nar/gkw583" class="uri">doi:10.1093/nar/gkw583</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#binding-score">Binding score</a></li>
      <li><a href="#cis-score">Cis score</a></li>
      <li><a href="#on--and-off-target-score">On- and off-target score</a></li>
      <li><a href="#optimal-guiderna-combination">Optimal guideRNA combination</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://scholar.google.de/citations?user=ossdDj4AAAAJ&amp;hl=en&amp;oi=ao">David Brocks</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
