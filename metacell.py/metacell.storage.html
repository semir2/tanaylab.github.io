

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>metacell.storage package &mdash; Metacell 0.5.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="metacell.dynamake package" href="metacell.dynamake.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Metacell
          

          
          </a>

          
            
            
              <div class="version">
                0.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License (MIT)</a></li>
</ul>
<p class="caption"><span class="caption-text">Code:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="metacell.html">metacell package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="metacell.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="metacell.bin.html">metacell.bin package</a></li>
<li class="toctree-l4"><a class="reference internal" href="metacell.dash.html">metacell.dash package</a></li>
<li class="toctree-l4"><a class="reference internal" href="metacell.dynamake.html">metacell.dynamake package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">metacell.storage package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.analyze">metacell.analyze module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.few_profiles">metacell.few_profiles module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.many_profiles">metacell.many_profiles module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.parameters">metacell.parameters module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.pick">metacell.pick module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.tracks">metacell.tracks module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.utilities">metacell.utilities module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.version">metacell.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell.visualizations">metacell.visualizations module</a></li>
<li class="toctree-l3"><a class="reference internal" href="metacell.html#module-metacell">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="cover/index.html#http://">coverage</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Metacell</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">metacell</a> &raquo;</li>
        
          <li><a href="metacell.html">metacell package</a> &raquo;</li>
        
      <li>metacell.storage package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="metacell-storage-package">
<h1>metacell.storage package<a class="headerlink" href="#metacell-storage-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-metacell.storage.genes">
<span id="metacell-storage-genes-module"></span><h2>metacell.storage.genes module<a class="headerlink" href="#module-metacell.storage.genes" title="Permalink to this headline">¶</a></h2>
<p>Manage storage of per-gene data.</p>
<dl class="class">
<dt id="metacell.storage.genes.Genes">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.genes.</code><code class="sig-name descname">Genes</code><span class="sig-paren">(</span><em class="sig-param">full: metacell.storage.genes.GenesSet</em>, <em class="sig-param">names: tgutils.numpy.ArrayStr</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.genes.Genes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A collection of genes with some associated data.</p>
<p>This must be consistent between all profiles that are processed together.</p>
<dl class="method">
<dt id="metacell.storage.genes.Genes.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">full: metacell.storage.genes.GenesSet</em>, <em class="sig-param">names: tgutils.numpy.ArrayStr</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.genes.Genes.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the genes.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.Genes.any_array">
<em class="property">abstract </em><code class="sig-name descname">any_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#metacell.storage.genes.Genes.any_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a per-gene data array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.Genes.array">
<code class="sig-name descname">array</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[A], name: str</em><span class="sig-paren">)</span> &#x2192; A<a class="headerlink" href="#metacell.storage.genes.Genes.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a per-gene data array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.Genes.available_data">
<em class="property">abstract </em><code class="sig-name descname">available_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.genes.Genes.available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the available data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.Genes.count">
<code class="sig-name descname">count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.Genes.count" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenient access to the number of genes.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.Genes.created">
<em class="property">static </em><code class="sig-name descname">created</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">organism: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.genes.Genes.created" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">genes.yaml</span></code> file after creating a genes directory.</p>
<p>At minimum, the directory should contain the gene names file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.Genes.full">
<code class="sig-name descname">full</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.Genes.full" title="Permalink to this definition">¶</a></dt>
<dd><p>The full gene set this is derived from.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.Genes.has_array">
<em class="property">abstract </em><code class="sig-name descname">has_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.genes.Genes.has_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there exists some per-gene data.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.Genes.load">
<em class="property">static </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">organism: Optional[str] = None</em><span class="sig-paren">)</span> &#x2192; metacell.storage.genes.Genes<a class="headerlink" href="#metacell.storage.genes.Genes.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load genes from a directory.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.Genes.names">
<code class="sig-name descname">names</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.Genes.names" title="Permalink to this definition">¶</a></dt>
<dd><p>The sorted upper-case names of genes in the set.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.Genes.uuid">
<code class="sig-name descname">uuid</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.Genes.uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>The unique identifier of this list of gene names.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.genes.GenesMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.genes.</code><code class="sig-name descname">GenesMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.genes.GenesMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.metadata.YamlMetadata" title="metacell.storage.metadata.YamlMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.metadata.YamlMetadata</span></code></a></p>
<p>Per-batch meta-data.</p>
<dl class="method">
<dt id="metacell.storage.genes.GenesMetadata.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.genes.GenesMetadata.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create metadata for for some genes.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.GenesMetadata.genes_count">
<code class="sig-name descname">genes_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.GenesMetadata.genes_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of genes.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.GenesMetadata.organism">
<code class="sig-name descname">organism</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.GenesMetadata.organism" title="Permalink to this definition">¶</a></dt>
<dd><p>The organism these are genes of.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.GenesMetadata.required_keys">
<code class="sig-name descname">required_keys</code><em class="property"> = {'genes_count': &lt;class 'int'&gt;, 'organism': &lt;class 'str'&gt;, 'uuid': &lt;class 'str'&gt;}</em><a class="headerlink" href="#metacell.storage.genes.GenesMetadata.required_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.genes.GenesSet">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.genes.</code><code class="sig-name descname">GenesSet</code><span class="sig-paren">(</span><em class="sig-param">metadata: metacell.storage.genes.GenesMetadata</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.genes.GenesSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.genes.Genes" title="metacell.storage.genes.Genes"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.genes.Genes</span></code></a></p>
<p>A set of genes with some associated data.</p>
<p>This must be consistent between all batches that are processed together.</p>
<dl class="method">
<dt id="metacell.storage.genes.GenesSet.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metadata: metacell.storage.genes.GenesMetadata</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.genes.GenesSet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a genes set directory for access.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSet.any_array">
<code class="sig-name descname">any_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#metacell.storage.genes.GenesSet.any_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a per-gene data array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSet.available_data">
<code class="sig-name descname">available_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.genes.GenesSet.available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the available data.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSet.data_path">
<code class="sig-name descname">data_path</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.genes.GenesSet.data_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the path of a data file in the genes directory.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSet.has_array">
<code class="sig-name descname">has_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.genes.GenesSet.has_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there exists some per-gene data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.GenesSet.metadata">
<code class="sig-name descname">metadata</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.GenesSet.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>The meta-data describing the genes.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.genes.GenesSubset">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.genes.</code><code class="sig-name descname">GenesSubset</code><span class="sig-paren">(</span><em class="sig-param">superset: metacell.storage.genes.Genes</em>, <em class="sig-param">included_indices: tgutils.numpy.ArrayInt32</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.genes.GenesSubset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.genes.Genes" title="metacell.storage.genes.Genes"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.genes.Genes</span></code></a></p>
<p>A subset of some genes.</p>
<dl class="method">
<dt id="metacell.storage.genes.GenesSubset.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">superset: metacell.storage.genes.Genes</em>, <em class="sig-param">included_indices: tgutils.numpy.ArrayInt32</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.genes.GenesSubset.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a subset of some genes.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSubset.any_array">
<code class="sig-name descname">any_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#metacell.storage.genes.GenesSubset.any_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a per-gene data array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSubset.available_data">
<code class="sig-name descname">available_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.genes.GenesSubset.available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the available data.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.genes.GenesSubset.has_array">
<code class="sig-name descname">has_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.genes.GenesSubset.has_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether there exists some per-gene data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.GenesSubset.included_indices">
<code class="sig-name descname">included_indices</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.GenesSubset.included_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>The indices of the superset genes which are included in the subset.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.genes.GenesSubset.superset">
<code class="sig-name descname">superset</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.genes.GenesSubset.superset" title="Permalink to this definition">¶</a></dt>
<dd><p>The genes this is a subset of.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-metacell.storage.hca">
<span id="metacell-storage-hca-module"></span><h2>metacell.storage.hca module<a class="headerlink" href="#module-metacell.storage.hca" title="Permalink to this headline">¶</a></h2>
<p>Handle HCA (h5) files.</p>
</div>
<div class="section" id="module-metacell.storage.helpers">
<span id="metacell-storage-helpers-module"></span><h2>metacell.storage.helpers module<a class="headerlink" href="#module-metacell.storage.helpers" title="Permalink to this headline">¶</a></h2>
<p>Helper functions.</p>
<dl class="function">
<dt id="metacell.storage.helpers.combine_uuids">
<code class="sig-prename descclassname">metacell.storage.helpers.</code><code class="sig-name descname">combine_uuids</code><span class="sig-paren">(</span><em class="sig-param">uuids: List[uuid.UUID]</em><span class="sig-paren">)</span> &#x2192; uuid.UUID<a class="headerlink" href="#metacell.storage.helpers.combine_uuids" title="Permalink to this definition">¶</a></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">md5sum</span></code> to combine multiple UUIDs into a single UUID.</p>
</dd></dl>

<dl class="function">
<dt id="metacell.storage.helpers.file_uuid">
<code class="sig-prename descclassname">metacell.storage.helpers.</code><code class="sig-name descname">file_uuid</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span> &#x2192; uuid.UUID<a class="headerlink" href="#metacell.storage.helpers.file_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a checksum of a disk file.</p>
</dd></dl>

<dl class="function">
<dt id="metacell.storage.helpers.sum_profiles_loop">
<code class="sig-prename descclassname">metacell.storage.helpers.</code><code class="sig-name descname">sum_profiles_loop</code><span class="sig-paren">(</span><em class="sig-param">expected: int</em><span class="sig-paren">)</span> &#x2192; tgutils.application.Loop<a class="headerlink" href="#metacell.storage.helpers.sum_profiles_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a logged loop for summing profiles.</p>
</dd></dl>

</div>
<div class="section" id="module-metacell.storage.imports">
<span id="metacell-storage-imports-module"></span><h2>metacell.storage.imports module<a class="headerlink" href="#module-metacell.storage.imports" title="Permalink to this headline">¶</a></h2>
<p>Handle multi-lane sparse format data.</p>
<dl class="class">
<dt id="metacell.storage.imports.CsvFormat">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.imports.</code><code class="sig-name descname">CsvFormat</code><span class="sig-paren">(</span><em class="sig-param">path: str, data: Dict[str, Any]</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.imports.CsvFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Describe the format of a CSV file.</p>
<dl class="method">
<dt id="metacell.storage.imports.CsvFormat.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path: str, data: Dict[str, Any]</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.CsvFormat.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct from an entry in a <code class="docutils literal notranslate"><span class="pre">format.yaml</span></code> file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.CsvFormat.field_names">
<code class="sig-name descname">field_names</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.CsvFormat.field_names" title="Permalink to this definition">¶</a></dt>
<dd><p>When the file has no header line, assume this header line is used.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.CsvFormat.field_types">
<code class="sig-name descname">field_types</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.CsvFormat.field_types" title="Permalink to this definition">¶</a></dt>
<dd><p>For each recognized field of the file, its expected data type.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.CsvFormat.separator">
<code class="sig-name descname">separator</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.CsvFormat.separator" title="Permalink to this definition">¶</a></dt>
<dd><p>The separator between fields.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.imports.DelaneData">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.imports.</code><code class="sig-name descname">DelaneData</code><a class="headerlink" href="#metacell.storage.imports.DelaneData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data needed to delane the UMIs matrix.</p>
<dl class="method">
<dt id="metacell.storage.imports.DelaneData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.DelaneData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.DelaneData.data_of_lanes">
<code class="sig-name descname">data_of_lanes</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.DelaneData.data_of_lanes" title="Permalink to this definition">¶</a></dt>
<dd><p>The per-lane data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.DelaneData.data_of_profiles">
<code class="sig-name descname">data_of_profiles</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.DelaneData.data_of_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The per-profile data by the 0-based original index.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.imports.DelaneData.get_lane">
<code class="sig-name descname">get_lane</code><span class="sig-paren">(</span><em class="sig-param">lane_name: str</em><span class="sig-paren">)</span> &#x2192; metacell.storage.imports.LaneData<a class="headerlink" href="#metacell.storage.imports.DelaneData.get_lane" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the data for a specific lane.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.imports.DirFormat">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.imports.</code><code class="sig-name descname">DirFormat</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.imports.DirFormat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Describe the format of all CSV files in a standard format directory.</p>
<dl class="method">
<dt id="metacell.storage.imports.DirFormat.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.DirFormat.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the format from a <code class="docutils literal notranslate"><span class="pre">format.yaml</span></code> file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.DirFormat.genes">
<code class="sig-name descname">genes</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.DirFormat.genes" title="Permalink to this definition">¶</a></dt>
<dd><p>The format of the genes CSV file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.DirFormat.profiles">
<code class="sig-name descname">profiles</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.DirFormat.profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The format of the profiles CSV file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.imports.LaneData">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.imports.</code><code class="sig-name descname">LaneData</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.imports.LaneData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Per-lane data needed to delane the UMIs matrix.</p>
<dl class="method">
<dt id="metacell.storage.imports.LaneData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.LaneData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize empty lane data.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.imports.LaneData.add_entry">
<code class="sig-name descname">add_entry</code><span class="sig-paren">(</span><em class="sig-param">gene_index: int</em>, <em class="sig-param">profile_index: int</em>, <em class="sig-param">umis_count: int</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.LaneData.add_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a scanned UMIs entry to the lane.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.LaneData.entry_lines">
<code class="sig-name descname">entry_lines</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.LaneData.entry_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>The lines of the entries of the lane.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.LaneData.last_profile_data_line_index">
<code class="sig-name descname">last_profile_data_line_index</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.LaneData.last_profile_data_line_index" title="Permalink to this definition">¶</a></dt>
<dd><p>The last profile data line index of the lane.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.LaneData.name">
<code class="sig-name descname">name</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.LaneData.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The unique lane name.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.LaneData.profiles_count">
<code class="sig-name descname">profiles_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.LaneData.profiles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of profiles in the lane.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.imports.LaneData.write_umis_matrix">
<code class="sig-name descname">write_umis_matrix</code><span class="sig-paren">(</span><em class="sig-param">delaned_root: str</em>, <em class="sig-param">umis_header_line: str</em>, <em class="sig-param">genes_count: int</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.LaneData.write_umis_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the collected entries into the UMIs matrix file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.imports.ProfileData">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.imports.</code><code class="sig-name descname">ProfileData</code><span class="sig-paren">(</span><em class="sig-param">lane_data: metacell.storage.imports.LaneData</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.imports.ProfileData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Per-profile data needed to delane the UMIs matrix.</p>
<dl class="method">
<dt id="metacell.storage.imports.ProfileData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">lane_data: metacell.storage.imports.LaneData</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.imports.ProfileData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize scanned profile data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.ProfileData.index_in_lane">
<code class="sig-name descname">index_in_lane</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.ProfileData.index_in_lane" title="Permalink to this definition">¶</a></dt>
<dd><p>The 1-based index of the profile in the lane.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.imports.ProfileData.lane_data">
<code class="sig-name descname">lane_data</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.imports.ProfileData.lane_data" title="Permalink to this definition">¶</a></dt>
<dd><p>The lane the profile belongs to.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-metacell.storage.matrices">
<span id="metacell-storage-matrices-module"></span><h2>metacell.storage.matrices module<a class="headerlink" href="#module-metacell.storage.matrices" title="Permalink to this headline">¶</a></h2>
<p>Memory-mapped matrices for observations storage.</p>
<dl class="data">
<dt id="metacell.storage.matrices.MAGIC_BYTES">
<code class="sig-prename descclassname">metacell.storage.matrices.</code><code class="sig-name descname">MAGIC_BYTES</code><em class="property"> = b'METACELL SPARSE MEMORY MAPPED MATRIX VERSION 0\x00\x00'</em><a class="headerlink" href="#metacell.storage.matrices.MAGIC_BYTES" title="Permalink to this definition">¶</a></dt>
<dd><p>The magic string for a sparse memory mapped matrix.</p>
</dd></dl>

<dl class="data">
<dt id="metacell.storage.matrices.MAGIC_SIZE">
<code class="sig-prename descclassname">metacell.storage.matrices.</code><code class="sig-name descname">MAGIC_SIZE</code><em class="property"> = 48</em><a class="headerlink" href="#metacell.storage.matrices.MAGIC_SIZE" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the magic string identifying the file type.</p>
</dd></dl>

<dl class="class">
<dt id="metacell.storage.matrices.MemoryMappedMatrix">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.matrices.</code><code class="sig-name descname">MemoryMappedMatrix</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A read-only memory mapped file containing a series of integer measurements per profile.</p>
<p>This is optimized to allow for accessing the data of arbitrary profiles.
It does not allow for efficient extraction of the data of arbitrary genes.</p>
<p>The file format is as follows:</p>
<ul class="simple">
<li><p>Magic string: containing the <code class="xref py py-data docutils literal notranslate"><span class="pre">metadata.storage.matrices.MAGIC_BYTES</span></code>.</p></li>
<li><p>Profiles count: 4-bytes little-endian.</p></li>
<li><p>Genes count: 4-bytes little-endian.</p></li>
<li><p>Profiles data: See below.</p></li>
<li><p>Padding to 4 bytes alignment using 0 bytes.</p></li>
<li><p>Index of offsets of profile data: See below.</p></li>
</ul>
<p>The format of the index of the offsets is as follows:</p>
<ul class="simple">
<li><p>For each profile, the 4-byte little-endian offset of the 1st byte of its data.</p></li>
<li><p>Finally, the offset of the 1st byte following the data of the last profile.</p></li>
</ul>
<p>The format of the profile data is as follows:</p>
<ul class="simple">
<li><p>A sequence of pairs of bytes, where the 1st byte is the unsigned delta to apply to the
current gene index, and the 2nd byte is the unsigned value to add to the current gene of the
profile.</p></li>
</ul>
<p>This format is very compact when more than 1/256 of the genes have non-zero data,
and when the measurement value is typically less than 256.
When genes are sparser, we
write additional byte pairs with a delta gene index of 255 and measurement of 0.
When the measurement value is too high,
we write additional byte pairs with a delta gene index of 0.</p>
<p>Decompression is reasonably fast as there are no branches involved.
It is difficult to vectorize but the saving in I/O (especially when
accessing the data over a network) “should” justify this compression.
However it is trivial to parallelize decompression of multiple profile data.</p>
<p>The compression rate is pretty good (around 1/50 compared to dense encoding). The
optimal number of bits for the genes and measurement deltas is actually 8 and 4, respectively.
However, this complicates the code and only reduces the file sizes by around 20%.
Using an optimized Huffman tree or <code class="docutils literal notranslate"><span class="pre">gzip</span></code> it is possible to further compress the result to
around 1/2th the current size, but this would come at the cost of much slower decompression
speed.</p>
<p>The profile data offsets index appears at the end of the file, but its location is known
to be <code class="docutils literal notranslate"><span class="pre">file_size</span> <span class="pre">-</span> <span class="pre">(profiles_count</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">*</span> <span class="pre">4</span></code>.
The profiles count is known to be at the offset
<code class="xref py py-data docutils literal notranslate"><span class="pre">metaprofile.storage.matrices.MAGIC_SIZE</span></code>.</p>
<p>All 4-byte values are stored on a 4-byte aligned offset, and are in little-endian order.
This allowing a memory-mapped implementation on most processors to decode the value
using an efficient aligned pointer dereference.</p>
<dl class="method">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a read-only memory-mapped matrix file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.add_profile_data">
<code class="sig-name descname">add_profile_data</code><span class="sig-paren">(</span><em class="sig-param">profile_index: int</em>, <em class="sig-param">array: tgutils.numpy.ArrayFloat32</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.add_profile_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the profile data into a numpy array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Release all the resources held by the file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.entries_count">
<code class="sig-name descname">entries_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.entries_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total number of non-zero entries in the matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.genes_count">
<code class="sig-name descname">genes_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.genes_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of genes in the matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.mmap">
<code class="sig-name descname">mmap</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.mmap" title="Permalink to this definition">¶</a></dt>
<dd><p>The mapped memory.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.profiles_count">
<code class="sig-name descname">profiles_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.profiles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of profiles in the matrix.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.to_numpy_matrix">
<code class="sig-name descname">to_numpy_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; tgutils.numpy.MatrixFloat32<a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.to_numpy_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full matrix as a dense numpy array, whose rows are genes,
columns are profiles, and entries are 4-byte integers containing observations.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.matrices.MemoryMappedMatrix.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">path: str, genes_count: int, data: List[List[Tuple[int, int]]]</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.matrices.MemoryMappedMatrix.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a sparse memory-mapped matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – The path of the disk file to write.</p></li>
<li><p><strong>genes_count</strong> – The number of genes (size of gene set).</p></li>
<li><p><strong>data</strong> – A list of profile data,
where each profile data is a list of tuples,
where each tuple has a gene index and an observation.
The list of tuples must be sorted by the gene index.
Entries with zero observations are allowed, and have no effect on the output.
Multiple tuples with the same gene index are allowed, and are summed into the output.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-metacell.storage.metadata">
<span id="metacell-storage-metadata-module"></span><h2>metacell.storage.metadata module<a class="headerlink" href="#module-metacell.storage.metadata" title="Permalink to this headline">¶</a></h2>
<p>Manage meta-data in YAML files.</p>
<dl class="class">
<dt id="metacell.storage.metadata.YamlMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.metadata.</code><code class="sig-name descname">YamlMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.metadata.YamlMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">types.SimpleNamespace</span></code></p>
<p>Meta-data stored in a YAML file.</p>
<dl class="method">
<dt id="metacell.storage.metadata.YamlMetadata.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the metadata object.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.metadata.YamlMetadata.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the metadata as a clean dictionary for dumping to YAML.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.metadata.YamlMetadata.detect_cls">
<em class="property">static </em><code class="sig-name descname">detect_cls</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[YM], _dictionary: Dict[str, Any]</em><span class="sig-paren">)</span> &#x2192; Type[YM]<a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.detect_cls" title="Permalink to this definition">¶</a></dt>
<dd><p>Decide on the concrete metadata class to load from the dictionary.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.metadata.YamlMetadata.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param">yaml_path: str</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump batch metadata into a file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.metadata.YamlMetadata.load">
<em class="property">classmethod </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">yaml_path: str</em><span class="sig-paren">)</span> &#x2192; YM<a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the batch meta-data from a file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.metadata.YamlMetadata.path">
<code class="sig-name descname">path</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path of the directory containing the data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.metadata.YamlMetadata.removed_keys">
<code class="sig-name descname">removed_keys</code><em class="property"> = ['path', 'yaml_path']</em><a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.removed_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>The keys that should be removed from the YAML file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.metadata.YamlMetadata.required_keys">
<code class="sig-name descname">required_keys</code><em class="property"> = {'uuid': &lt;class 'str'&gt;}</em><a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.required_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>The keys that must appear in the YAML file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.metadata.YamlMetadata.uuid">
<code class="sig-name descname">uuid</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>The globally unique identifier of the data.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.metadata.YamlMetadata.yaml_path">
<code class="sig-name descname">yaml_path</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.metadata.YamlMetadata.yaml_path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path of the YAML meta-data file.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-metacell.storage.profiles">
<span id="metacell-storage-profiles-module"></span><h2>metacell.storage.profiles module<a class="headerlink" href="#module-metacell.storage.profiles" title="Permalink to this headline">¶</a></h2>
<p>Maintain per-gene-per-profile UMIs data on the disk.</p>
<dl class="class">
<dt id="metacell.storage.profiles.CombinedMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">CombinedMetadata</code><span class="sig-paren">(</span><em class="sig-param">yaml_path: str</em>, <em class="sig-param">data: Any</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.CombinedMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">types.SimpleNamespace</span></code></p>
<p>Per-combined profiles container metadata.</p>
<dl class="method">
<dt id="metacell.storage.profiles.CombinedMetadata.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">yaml_path: str</em>, <em class="sig-param">data: Any</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.CombinedMetadata.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the meta-data from a YAML file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.CombinedMetadata.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="headerlink" href="#metacell.storage.profiles.CombinedMetadata.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the metadata as a clean dictionary for dumping to YAML.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.CombinedMetadata.name">
<code class="sig-name descname">name</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.CombinedMetadata.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the combined container in the collection.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.CombinedMetadata.profiles_count">
<code class="sig-name descname">profiles_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.CombinedMetadata.profiles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of profiles in the combined container.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.CombinedMetadata.uuid">
<code class="sig-name descname">uuid</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.CombinedMetadata.uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>The unique identifier of the combined container.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.Profiles">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">Profiles</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.Profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Common base class for all profile containers.</p>
<dl class="method">
<dt id="metacell.storage.profiles.Profiles.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.Profiles.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.add_into_gp_array">
<code class="sig-name descname">add_into_gp_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">profile_index: int</em>, <em class="sig-param">profile_array: tgutils.numpy.ArrayFloat32</em><span class="sig-paren">)</span> &#x2192; tgutils.numpy.ArrayFloat32<a class="headerlink" href="#metacell.storage.profiles.Profiles.add_into_gp_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the requested data of a profile into an array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.any_array">
<code class="sig-name descname">any_array</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#metacell.storage.profiles.Profiles.any_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a per-gene or per-profile array of any type.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.any_frame">
<code class="sig-name descname">any_frame</code><span class="sig-paren">(</span><em class="sig-param">kind: str, name: str, *, profile_indices: Optional[Collection], gene_indices: Optional[Collection]</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#metacell.storage.profiles.Profiles.any_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a per-gene/gene, per-gene/profile or per-profile/profile data of any type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The returned frame index for genes (for <code class="docutils literal notranslate"><span class="pre">gg</span></code> and <code class="docutils literal notranslate"><span class="pre">gp</span></code>) is the gene names, even
though the <code class="docutils literal notranslate"><span class="pre">gene_indices</span></code> parameter uses the integer index. Both the
<code class="docutils literal notranslate"><span class="pre">profile_indices</span></code> and the returned frame index for profiles (for <code class="docutils literal notranslate"><span class="pre">gp</span></code> and <code class="docutils literal notranslate"><span class="pre">pp</span></code>)
use the integer profile indices.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.any_matrix">
<code class="sig-name descname">any_matrix</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em>, <em class="sig-param">profile_indices: Optional[Collection] = None</em>, <em class="sig-param">gene_indices: Optional[Collection] = None</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#metacell.storage.profiles.Profiles.any_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a per-gene/gene, per-gene/profile or per-profile/profile data of any type.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.any_series">
<code class="sig-name descname">any_series</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; pandas.core.series.Series<a class="headerlink" href="#metacell.storage.profiles.Profiles.any_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a series of per-gene or per-profile data of any type.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.array">
<code class="sig-name descname">array</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[A], kind: str, name: str</em><span class="sig-paren">)</span> &#x2192; A<a class="headerlink" href="#metacell.storage.profiles.Profiles.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a per-gene or per-profile array of some type.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.available_data">
<code class="sig-name descname">available_data</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.Profiles.available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the available data of the specified kind (‘g’, ‘p’, ‘gp’, ‘gg’ or ‘pp’).</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.data_path">
<code class="sig-name descname">data_path</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.profiles.Profiles.data_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the path of a data file in the container directory.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.dir_paths">
<em class="property">abstract </em><code class="sig-name descname">dir_paths</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.Profiles.dir_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of directories containing actual UMIs data for the container.</p>
<p>This is just a single path for a batch, and a list for a merged collection of batches.
For a view it contains the view’s directory in addition to the base container’s.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.frame">
<code class="sig-name descname">frame</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[F], kind: str, name: str, *, profile_indices: Optional[Collection] = None, gene_indices: Optional[Collection] = None</em><span class="sig-paren">)</span> &#x2192; F<a class="headerlink" href="#metacell.storage.profiles.Profiles.frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a per-gene/gene, per-gene/profile or per-profile/profile data of some type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The returned frame index for genes (for <code class="docutils literal notranslate"><span class="pre">gg</span></code> and <code class="docutils literal notranslate"><span class="pre">gp</span></code>) is the gene names, even
though the <code class="docutils literal notranslate"><span class="pre">gene_indices</span></code> parameter uses the integer index. Both the
<code class="docutils literal notranslate"><span class="pre">profile_indices</span></code> and the returned frame index for profiles (for <code class="docutils literal notranslate"><span class="pre">gp</span></code> and <code class="docutils literal notranslate"><span class="pre">pp</span></code>)
use the integer profile indices.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.Profiles.genes">
<code class="sig-name descname">genes</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.Profiles.genes" title="Permalink to this definition">¶</a></dt>
<dd><p>The genes set stored for each profile.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.has_array">
<code class="sig-name descname">has_array</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.Profiles.has_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the container contains some per-gene or per-profile data file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.has_matrix">
<code class="sig-name descname">has_matrix</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.Profiles.has_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the container contains some per-gene/gene, per-gene/profile or
per-profile/profile data file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.load">
<em class="property">static </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">*</em>, <em class="sig-param">name: str = ''</em>, <em class="sig-param">profiles_kind: Optional[str] = None</em><span class="sig-paren">)</span> &#x2192; metacell.storage.profiles.Profiles<a class="headerlink" href="#metacell.storage.profiles.Profiles.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a profiles container from disk directory.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.matrix">
<code class="sig-name descname">matrix</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[A], kind: str, name: str, *, profile_indices: Optional[Collection] = None, gene_indices: Optional[Collection] = None</em><span class="sig-paren">)</span> &#x2192; A<a class="headerlink" href="#metacell.storage.profiles.Profiles.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a per-gene/gene, per-gene/profile or per-profile/profile data of any type.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.Profiles.metadata">
<code class="sig-name descname">metadata</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.Profiles.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>The meta-data describing the container.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.Profiles.name">
<code class="sig-name descname">name</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.Profiles.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The human friendly name of the container.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.profile_indices">
<code class="sig-name descname">profile_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; tgutils.numpy.ArrayInt32<a class="headerlink" href="#metacell.storage.profiles.Profiles.profile_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of profile indices.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.profile_name">
<em class="property">abstract </em><code class="sig-name descname">profile_name</code><span class="sig-paren">(</span><em class="sig-param">profile_index: int</em>, <em class="sig-param">*</em>, <em class="sig-param">base_index: int = 0</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.profiles.Profiles.profile_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a human-friendly profile name.</p>
<p>This uses the profile’s barcode (if a <code class="docutils literal notranslate"><span class="pre">p.barcode.txt</span></code> file exists), otherwise the
numeric profile index. In both cases the name is prefixed with the specific batch name, if
any.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.profile_names">
<code class="sig-name descname">profile_names</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">base_index: int = 0</em><span class="sig-paren">)</span> &#x2192; tgutils.numpy.ArrayStr<a class="headerlink" href="#metacell.storage.profiles.Profiles.profile_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of all the profile names.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.Profiles.profiles_count">
<code class="sig-name descname">profiles_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.Profiles.profiles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of profiles in the container (to be filled by the sub-class).</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.series">
<code class="sig-name descname">series</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[S], kind: str, name: str</em><span class="sig-paren">)</span> &#x2192; S<a class="headerlink" href="#metacell.storage.profiles.Profiles.series" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a series of per-gene or per-profile data of some type.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.total_umis">
<code class="sig-name descname">total_umis</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">profile_indices: Optional[Collection] = None</em><span class="sig-paren">)</span> &#x2192; tgutils.numpy.ArrayFloat32<a class="headerlink" href="#metacell.storage.profiles.Profiles.total_umis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of the per-gene or per-profile total UMIs, for all or some of the profiles.</p>
<p>The first time this is called (only for all the profiles), it ts cached on disk.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.Profiles.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">cls: Type[A], array: A, kind: str, name: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.Profiles.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a data array or matrix into the container.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesBatch">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesBatch</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.Profiles" title="metacell.storage.profiles.Profiles"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.Profiles</span></code></a></p>
<p>A batch of UMIs measurement profiles.</p>
<dl class="method">
<dt id="metacell.storage.profiles.ProfilesBatch.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesBatch.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a batch of profiles for access.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesBatch.created">
<em class="property">static </em><code class="sig-name descname">created</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">profiles_kind: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesBatch.created" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">profiles.yaml</span></code> file after creating a profiles batch in some directory.</p>
<p>At minimum, the directory should include a raw UMIs matrix.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesBatch.dir_paths">
<code class="sig-name descname">dir_paths</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.ProfilesBatch.dir_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of directories containing actual UMIs data for the container.</p>
<p>This is just a single path for a batch, and a list for a merged collection of batches.
For a view it contains the view’s directory in addition to the base container’s.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesBatch.metadata">
<code class="sig-name descname">metadata</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesBatch.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>The meta-data describing the batch.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesBatch.profile_name">
<code class="sig-name descname">profile_name</code><span class="sig-paren">(</span><em class="sig-param">profile_index: int</em>, <em class="sig-param">*</em>, <em class="sig-param">base_index: int = 0</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.profiles.ProfilesBatch.profile_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a human-friendly profile name.</p>
<p>This uses the profile’s barcode (if a <code class="docutils literal notranslate"><span class="pre">p.barcode.txt</span></code> file exists), otherwise the
numeric profile index. In both cases the name is prefixed with the specific batch name, if
any.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesBatchMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesBatchMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesBatchMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.ProfilesMetadata" title="metacell.storage.profiles.ProfilesMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesMetadata</span></code></a></p>
<p>Per-batch meta-data.</p>
<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesBatchMetadata.container">
<code class="sig-name descname">container</code><a class="headerlink" href="#metacell.storage.profiles.ProfilesBatchMetadata.container" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#metacell.storage.profiles.ProfilesBatch" title="metacell.storage.profiles.ProfilesBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesBatch</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesCollection">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesCollection</code><span class="sig-paren">(</span><em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.Profiles" title="metacell.storage.profiles.Profiles"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.Profiles</span></code></a></p>
<p>A collection of named containers.</p>
<p>Each combined container is a sub-directory which is, itself, a profiles container. Per-profile
and per-gene-per-profile data is collected from the leaf (batch or view) containers.</p>
<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.add_into_gp_array">
<code class="sig-name descname">add_into_gp_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">profile_index: int</em>, <em class="sig-param">profile_array: tgutils.numpy.ArrayFloat32</em><span class="sig-paren">)</span> &#x2192; tgutils.numpy.ArrayFloat32<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.add_into_gp_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the requested data of a profile into an array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.available_data">
<code class="sig-name descname">available_data</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the available data of the specified kind (‘g’, ‘p’, ‘gp’, ‘gg’ or ‘pp’).</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.container_index_of_profile">
<code class="sig-name descname">container_index_of_profile</code><span class="sig-paren">(</span><em class="sig-param">profile_index: int</em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.container_index_of_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the container to which a specific profile belongs.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollection.containers">
<code class="sig-name descname">containers</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.containers" title="Permalink to this definition">¶</a></dt>
<dd><p>The combined (leaf) containers.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.created">
<em class="property">static </em><code class="sig-name descname">created</code><span class="sig-paren">(</span><em class="sig-param">path: str, combined_dirs: List[str]</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.created" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">profiles.yaml</span></code> file after creating a profiles collection in some directory.</p>
<p>The directory should include all the combined profile containers.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.dir_paths">
<code class="sig-name descname">dir_paths</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.dir_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of directories containing actual UMIs data for the container.</p>
<p>This is just a single path for a batch, and a list for a merged collection of batches.
For a view it contains the view’s directory in addition to the base container’s.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollection.first_profile_indices">
<code class="sig-name descname">first_profile_indices</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.first_profile_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>The first index of each container (for searching).</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.has_array">
<code class="sig-name descname">has_array</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.has_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the container contains some per-gene or per-profile data file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.has_matrix">
<code class="sig-name descname">has_matrix</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.has_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the container contains some per-gene/gene, per-gene/profile or
per-profile/profile data file.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollection.index_by_name">
<code class="sig-name descname">index_by_name</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.index_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The index of a combined container by its name.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollection.metadata">
<code class="sig-name descname">metadata</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>The meta-data describing the collection.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollection.profile_name">
<code class="sig-name descname">profile_name</code><span class="sig-paren">(</span><em class="sig-param">profile_index: int</em>, <em class="sig-param">*</em>, <em class="sig-param">base_index: int = 0</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollection.profile_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a human-friendly profile name.</p>
<p>This uses the profile’s barcode (if a <code class="docutils literal notranslate"><span class="pre">p.barcode.txt</span></code> file exists), otherwise the
numeric profile index. In both cases the name is prefixed with the specific batch name, if
any.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesCollectionMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesCollectionMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollectionMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.ProfilesMetadata" title="metacell.storage.profiles.ProfilesMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesMetadata</span></code></a></p>
<p>Per-collection meta-data.</p>
<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollectionMetadata.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollectionMetadata.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create metadata for a collection of batches of profiles.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesCollectionMetadata.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="headerlink" href="#metacell.storage.profiles.ProfilesCollectionMetadata.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the metadata as a clean dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollectionMetadata.combined_profiles">
<code class="sig-name descname">combined_profiles</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollectionMetadata.combined_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of batches contained in the collection.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollectionMetadata.container">
<code class="sig-name descname">container</code><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollectionMetadata.container" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#metacell.storage.profiles.ProfilesCollection" title="metacell.storage.profiles.ProfilesCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesCollection</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesCollectionMetadata.required_keys">
<code class="sig-name descname">required_keys</code><em class="property"> = {'combined_profiles': &lt;class 'list'&gt;, 'genes_count': &lt;class 'int'&gt;, 'genes_uuid': &lt;class 'str'&gt;, 'organism': &lt;class 'str'&gt;, 'profiles_count': &lt;class 'int'&gt;, 'profiles_kind': &lt;class 'str'&gt;, 'uuid': &lt;class 'str'&gt;}</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesCollectionMetadata.required_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesGroups">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesGroups</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.GenesSet</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesGroups" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.ProfilesBatch" title="metacell.storage.profiles.ProfilesBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesBatch</span></code></a></p>
<p>A batch of profiles where each one is the sum of a group of profiles from some other container.</p>
<dl class="method">
<dt id="metacell.storage.profiles.ProfilesGroups.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.GenesSet</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesGroups.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a view of a profiles groups container for access.</p>
<p>In this case, the passed genes parameter is the full genes, which must match the full genes
of the grouped container. The exact used genes are identical to the genes of the grouped
container.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesGroups.created">
<em class="property">static </em><code class="sig-name descname">created</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">grouped_profiles: metacell.storage.profiles.Profiles</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesGroups.created" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">profiles.yaml</span></code> file after creating a profiles groups in some directory.</p>
<p>The directory should contain the <code class="docutils literal notranslate"><span class="pre">p.grouped_count.npy</span></code> file with the size of each group.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesGroups.grouped_profiles">
<code class="sig-name descname">grouped_profiles</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesGroups.grouped_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The open grouped container.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesGroups.metadata">
<code class="sig-name descname">metadata</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesGroups.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>The meta-data describing the groups.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesGroupsMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesGroupsMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesGroupsMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.ProfilesBatchMetadata" title="metacell.storage.profiles.ProfilesBatchMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesBatchMetadata</span></code></a></p>
<p>Per-groups meta-data.</p>
<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesGroupsMetadata.container">
<code class="sig-name descname">container</code><a class="headerlink" href="#metacell.storage.profiles.ProfilesGroupsMetadata.container" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#metacell.storage.profiles.ProfilesGroups" title="metacell.storage.profiles.ProfilesGroups"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesGroups</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesGroupsMetadata.required_keys">
<code class="sig-name descname">required_keys</code><em class="property"> = {'genes_count': &lt;class 'int'&gt;, 'genes_uuid': &lt;class 'str'&gt;, 'grouped_profiles': &lt;class 'str'&gt;, 'grouped_uuid': &lt;class 'str'&gt;, 'organism': &lt;class 'str'&gt;, 'profiles_count': &lt;class 'int'&gt;, 'profiles_kind': &lt;class 'str'&gt;, 'uuid': &lt;class 'str'&gt;}</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesGroupsMetadata.required_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.metadata.YamlMetadata" title="metacell.storage.metadata.YamlMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.metadata.YamlMetadata</span></code></a></p>
<p>Common meta-data for any profiles container.</p>
<dl class="method">
<dt id="metacell.storage.profiles.ProfilesMetadata.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create metadata for a batch of profiles.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.container">
<code class="sig-name descname">container</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.container" title="Permalink to this definition">¶</a></dt>
<dd><p>The (concrete) container of the (derived) class.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesMetadata.detect_cls">
<em class="property">static </em><code class="sig-name descname">detect_cls</code><span class="sig-paren">(</span><em class="sig-param">_cls: Type[YM], dictionary: Dict[str, Any]</em><span class="sig-paren">)</span> &#x2192; Type[YM]<a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.detect_cls" title="Permalink to this definition">¶</a></dt>
<dd><p>Decide on the concrete metadata class to load from the dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.genes_count">
<code class="sig-name descname">genes_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.genes_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of genes.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.genes_uuid">
<code class="sig-name descname">genes_uuid</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.genes_uuid" title="Permalink to this definition">¶</a></dt>
<dd><p>The set of genes that were measured for each profile.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesMetadata.open">
<code class="sig-name descname">open</code><span class="sig-paren">(</span><em class="sig-param">genes: metacell.storage.genes.Genes</em>, <em class="sig-param">*</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span> &#x2192; metacell.storage.profiles.Profiles<a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the actual container for data access.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.organism">
<code class="sig-name descname">organism</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.organism" title="Permalink to this definition">¶</a></dt>
<dd><p>The organism the data is for (‘human’, ‘mouse’, etc.).</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.profiles_count">
<code class="sig-name descname">profiles_count</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.profiles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of profiles this contains.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.profiles_kind">
<code class="sig-name descname">profiles_kind</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.profiles_kind" title="Permalink to this definition">¶</a></dt>
<dd><p>The kind of profiles this contains (‘cells’, ‘metacells’, etc.)</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesMetadata.required_keys">
<code class="sig-name descname">required_keys</code><em class="property"> = {'genes_count': &lt;class 'int'&gt;, 'genes_uuid': &lt;class 'str'&gt;, 'organism': &lt;class 'str'&gt;, 'profiles_count': &lt;class 'int'&gt;, 'profiles_kind': &lt;class 'str'&gt;, 'uuid': &lt;class 'str'&gt;}</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesMetadata.required_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>The keys that must appear in the metadata YAML file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesView">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesView</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.GenesSet</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesView" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.ProfilesBatch" title="metacell.storage.profiles.ProfilesBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesBatch</span></code></a></p>
<p>A restricted view of some profiles container.</p>
<p>The view is specified using the two optional files, <code class="docutils literal notranslate"><span class="pre">p.base_index.npy</span></code> and
<code class="docutils literal notranslate"><span class="pre">genes.base_index.npy</span></code>. If missing, then the view is assumed to use the full profiles and/or
genes of the base container.</p>
<p>Having a view which uses the full base container data is useful when creating a new collection.
Such a “just a link” view allows the collection to refer to an arbitrary existing container,
without having to physically copy it into the collection directory. This is different from a
symbolic link in that it has different modification times (for <code class="docutils literal notranslate"><span class="pre">make</span></code>-like tools), and allows
creating additional computed data inside the view without modifying the original base container.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some data of the base container may not be meaningfully subset-able. For example,
<code class="docutils literal notranslate"><span class="pre">p.total_umis</span></code> would be incorrect if the view uses a subset of the genes. By
default, the code assumes all data is subset-able, as this allows for each access to
barcodes and other meta-data associated with each profile (or gene). To avoid subset-ing
computed data, add the name of the data to one of
<a class="reference internal" href="#metacell.storage.profiles.ProfilesView.GENES_DEPENDENT_DATA" title="metacell.storage.profiles.ProfilesView.GENES_DEPENDENT_DATA"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesView.GENES_DEPENDENT_DATA</span></code></a>,
<a class="reference internal" href="#metacell.storage.profiles.ProfilesView.PROFILES_DEPENDENT_DATA" title="metacell.storage.profiles.ProfilesView.PROFILES_DEPENDENT_DATA"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesView.PROFILES_DEPENDENT_DATA</span></code></a>.</p>
</div>
<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesView.GENES_DEPENDENT_DATA">
<code class="sig-name descname">GENES_DEPENDENT_DATA</code><em class="property"> = {'g': {'mean_fraction'}, 'gg': {}, 'gp': {}, 'p': {'total_umis'}, 'pp': {'balanced_ranks', 'correlation', 'edge_weights', 'pruned_ranks'}}</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesView.GENES_DEPENDENT_DATA" title="Permalink to this definition">¶</a></dt>
<dd><p>For each kind (<code class="docutils literal notranslate"><span class="pre">gp</span></code>, <code class="docutils literal notranslate"><span class="pre">gg</span></code>, <code class="docutils literal notranslate"><span class="pre">pp</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>), the names of data which depends on the
set of genes.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesView.PROFILES_DEPENDENT_DATA">
<code class="sig-name descname">PROFILES_DEPENDENT_DATA</code><em class="property"> = {'g': {'mean_fraction', 'total_umis'}, 'gg': {}, 'gp': {'fold_in_group'}, 'p': {}, 'pp': {'balanced_ranks', 'correlation', 'edge_weights', 'pruned_ranks'}}</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesView.PROFILES_DEPENDENT_DATA" title="Permalink to this definition">¶</a></dt>
<dd><p>For each kind (<code class="docutils literal notranslate"><span class="pre">gp</span></code>, <code class="docutils literal notranslate"><span class="pre">gg</span></code>, <code class="docutils literal notranslate"><span class="pre">pp</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>), the names of data which depends on the
set of profiles.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">metadata: metacell.storage.profiles.ProfilesMetadata</em>, <em class="sig-param">genes: metacell.storage.genes.GenesSet</em>, <em class="sig-param">name: str = ''</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a view of a profiles container for access.</p>
<p>In this case, the passed genes parameter is the full genes, which must match the full genes
of the base container. The exact used gene subset is computed based on the base container’s
genes, and the content of the <code class="docutils literal notranslate"><span class="pre">genes.base_index.npy</span></code> file, if any.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.add_into_gp_array">
<code class="sig-name descname">add_into_gp_array</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">profile_index: int</em>, <em class="sig-param">profile_array: tgutils.numpy.ArrayFloat32</em><span class="sig-paren">)</span> &#x2192; tgutils.numpy.ArrayFloat32<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.add_into_gp_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the requested data of a profile into an array.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.available_data">
<code class="sig-name descname">available_data</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the available data of the specified kind (‘g’, ‘p’, ‘gp’, ‘gg’ or ‘pp’).</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.base_gene_index">
<code class="sig-name descname">base_gene_index</code><span class="sig-paren">(</span><em class="sig-param">gene_index: int</em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.base_gene_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the gene in the base profiles container.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesView.base_gene_indices">
<code class="sig-name descname">base_gene_indices</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesView.base_gene_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>The indices of the included genes, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if all genes are included.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.base_profile_index">
<code class="sig-name descname">base_profile_index</code><span class="sig-paren">(</span><em class="sig-param">profile_index: int</em><span class="sig-paren">)</span> &#x2192; int<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.base_profile_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the profile in the base profiles container.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesView.base_profile_indices">
<code class="sig-name descname">base_profile_indices</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesView.base_profile_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>The indices of the included profiles, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if all profiles are included.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesView.base_profiles">
<code class="sig-name descname">base_profiles</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesView.base_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>The open base container.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.created">
<em class="property">static </em><code class="sig-name descname">created</code><span class="sig-paren">(</span><em class="sig-param">path: str</em>, <em class="sig-param">base_profiles: metacell.storage.profiles.Profiles</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.created" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">profiles.yaml</span></code> file after creating a profiles view in some directory.</p>
<p>The directory should contain the <code class="docutils literal notranslate"><span class="pre">base_index</span></code> files of the filtered profiles and/or genes.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.dir_paths">
<code class="sig-name descname">dir_paths</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.dir_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of directories containing actual UMIs data for the container.</p>
<p>This is just a single path for a batch, and a list for a merged collection of batches.
For a view it contains the view’s directory in addition to the base container’s.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.has_array">
<code class="sig-name descname">has_array</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.has_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the container contains some per-gene or per-profile data file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.has_matrix">
<code class="sig-name descname">has_matrix</code><span class="sig-paren">(</span><em class="sig-param">kind: str</em>, <em class="sig-param">name: str</em><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.has_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the container contains some per-gene/gene, per-gene/profile or
per-profile/profile data file.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.is_slicing">
<code class="sig-name descname">is_slicing</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.is_slicing" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the view only includes some of the base container’s data.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.is_slicing_genes">
<code class="sig-name descname">is_slicing_genes</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.is_slicing_genes" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the view only includes some of the base container’s genes.</p>
</dd></dl>

<dl class="method">
<dt id="metacell.storage.profiles.ProfilesView.is_slicing_profiles">
<code class="sig-name descname">is_slicing_profiles</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="headerlink" href="#metacell.storage.profiles.ProfilesView.is_slicing_profiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the view only includes some of the base container’s profiles.</p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesView.metadata">
<code class="sig-name descname">metadata</code><em class="property"> = None</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesView.metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>The meta-data describing the batch.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="metacell.storage.profiles.ProfilesViewMetadata">
<em class="property">class </em><code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">ProfilesViewMetadata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#metacell.storage.profiles.ProfilesViewMetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#metacell.storage.profiles.ProfilesBatchMetadata" title="metacell.storage.profiles.ProfilesBatchMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">metacell.storage.profiles.ProfilesBatchMetadata</span></code></a></p>
<p>Per-view meta-data.</p>
<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesViewMetadata.container">
<code class="sig-name descname">container</code><a class="headerlink" href="#metacell.storage.profiles.ProfilesViewMetadata.container" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#metacell.storage.profiles.ProfilesView" title="metacell.storage.profiles.ProfilesView"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProfilesView</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="metacell.storage.profiles.ProfilesViewMetadata.required_keys">
<code class="sig-name descname">required_keys</code><em class="property"> = {'base_profiles': &lt;class 'str'&gt;, 'base_uuid': &lt;class 'str'&gt;, 'genes_count': &lt;class 'int'&gt;, 'genes_uuid': &lt;class 'str'&gt;, 'organism': &lt;class 'str'&gt;, 'profiles_count': &lt;class 'int'&gt;, 'profiles_kind': &lt;class 'str'&gt;, 'uuid': &lt;class 'str'&gt;}</em><a class="headerlink" href="#metacell.storage.profiles.ProfilesViewMetadata.required_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="data">
<dt id="metacell.storage.profiles.RawMatrix">
<code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">RawMatrix</code><em class="property"> = typing.Union[metacell.storage.matrices.MemoryMappedMatrix, numpy.ndarray]</em><a class="headerlink" href="#metacell.storage.profiles.RawMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>A matrix of data per profile and gene.</p>
</dd></dl>

<dl class="function">
<dt id="metacell.storage.profiles.grouped_kind">
<code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">grouped_kind</code><span class="sig-paren">(</span><em class="sig-param">groups_kind: str</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.profiles.grouped_kind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the profiles kind for the grouped profiles.</p>
</dd></dl>

<dl class="function">
<dt id="metacell.storage.profiles.groups_kind">
<code class="sig-prename descclassname">metacell.storage.profiles.</code><code class="sig-name descname">groups_kind</code><span class="sig-paren">(</span><em class="sig-param">grouped_kind: str</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#metacell.storage.profiles.groups_kind" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the profiles kind for the profiles groups.</p>
</dd></dl>

</div>
<div class="section" id="module-metacell.storage.views">
<span id="metacell-storage-views-module"></span><h2>metacell.storage.views module<a class="headerlink" href="#module-metacell.storage.views" title="Permalink to this headline">¶</a></h2>
<p>Create profile views.</p>
</div>
<div class="section" id="module-metacell.storage">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-metacell.storage" title="Permalink to this headline">¶</a></h2>
<p>Manage disk storage of metacell data.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="metacell.dynamake.html" class="btn btn-neutral float-left" title="metacell.dynamake package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, Weizmann Institute of Science

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>